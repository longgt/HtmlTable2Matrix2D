"use strict";var L=Object.defineProperty;var m=(j,z)=>L(j,"name",{value:z,configurable:!0});/**
 * @license MIT License
 *
 * Copyright (c) 2023 longgt
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 **/(function(){let j={};j.mtTable=function(){let z,q;function A(e,n,r){let i=n,t=-1,l=r[0].length;for(let h=0;h<l;h++)if(r[e][h]>0&&t++,t==n){i=h;break}return i}m(A,"r2aPosition");function S(e,n,r){let i=0;for(let t=0;t<n;t++)r[e][t]<0&&i++;return n-i}m(S,"a2rPosition");function y(e,n,r,i){let t=[];if(r=="left"){if(n>0){let l=n-1,h=e;for(;l>=0&&i[h][l]==-2;)l--;for(;h>=0&&i[h][l]==-1;)h--;t.push(h),t.push(l)}}else if(r=="right"){if(n+1<i[0].length){let l=n+1,h=e;for(;h>=0&&i[h][l]==-1;)h--;t.push(h),t.push(l)}}else if(r=="up"){if(e>0){let l=n,h=e-1;for(;l>=0&&i[h][l]==-2;)l--;for(;h>=0&&i[h][l]==-1;)h--;t.push(h),t.push(l)}}else if(r=="down"&&e+1<i.length){let l=n,h=e+1;for(;l>=0&&i[h][l]==-2;)l--;t.push(h),t.push(l)}return t.length>0&&t[1]>=0?t[1]=S(t[0],t[1],i):t=[],t}m(y,"detectMergeCell");function C(e,n){if(!n||n.length==0||n[0]<0||n[1]<0)return;let r=!1,i=e.length;for(let t=0;t<i;t++)if(v=e[t],v[0]==n[0]&&v[1]==n[1])return r=!0,!1;r||e.push(n)}m(C,"add");function k(e,n,r){let i=[];if(i.push(e),n>=0){let t=n;for(;t>=0&&r[e][t]<0;)t--;i.push(t>=0?S(e,t,r):t)}else i.push(-1);return i}return m(k,"prevCell"),{reset:m(function(){this.mt=[],this.debug=!1},"reset"),load:m(function(e,n,r){typeof Array.fill=="undefined"&&(Array.prototype.fill=function(s){let o=this.length;for(let p=0;p<o;p++)this[p]=s;return this});let i=typeof e=="object"?e:document.querySelector(e),t=[],l=n?n.split(","):[];i.querySelectorAll("tr").forEach(s=>{let o=[];s.querySelectorAll("th,td").forEach(p=>{if(l.length>0){for(let a=0,d=l.length;a<d;a++)if(p.classList.contains(l[a]))return}let g=[];g.push(~~p.getAttribute("rowspan")||1),g.push(~~p.getAttribute("colspan")||1),o.push(g)}),t.push(o)});let h=[],f=t.length,u=0;for(let s=0,o=t.length>0?t[0].length:0;s<o;s++)u+=t[0][s][1];for(let s=0;s<f;s++){let o=new Array(u).fill(s+1);h.push(o)}for(let s=0;s<f;s++){let o=t[s],p=0,g=o.length;for(let a=0;a<g;a++){let d=o[a];for(;h[s][p]<0;)p++;let b=d[0],w=d[1];for(let x=1;x<w;x++)h[s][p+x]=-2;for(let x=1;x<b;x++){h[s+x][p]=-1;for(let M=1;M<w;M++)h[s+x][p+M]=-2}p+=w}}this.mt=h,this.debug=r},"load"),getRelCell:m(function(e,n,r){let i=[],t=A(e,n,this.mt),l=1,h=1,f=this.mt;for(;t+h<f[e].length&&f[e][t+h]==-2;)h++;for(;e+l<f.length&&f[e+l][t]==-1;)l++;for(let u=0;u<l;u++)for(let s=0;s<h;s++){if(s==0&&r=="left"){let o=y(e+u,t,"left",f);C(i,o)}if(s==h-1&&r=="right"){let o=y(e+u,t+s,"right",f);C(i,o)}if(u==0&&r=="up"){let o=y(e,t+s,"up",f);C(i,o)}if(u==l-1&&r=="down"){let o=y(e+u,t+s,"down",f);C(i,o)}}return i},"getRelCell"),getMultiRelCell:m(function(e,n){let r=[];if(e)for(let i=0,t=e.length;i<t;i++){let l=e[i],h=this.getRelCell(l[0],l[1],n);if(h.length>0)for(let f=0,u=h.length;f<u;f++)C(r,h[f])}return r},"getMultiRelCell"),getHtmlStructure:m(function(){let e=[],n=this.mt;rowCnt=n.length;for(let r=0;r<rowCnt;r++){let i=[];colCnt=n[r].length;for(let t=0;t<colCnt;)if(n[r][t]>=0){let l=1,h=1;for(;t+l<colCnt&&n[r][t+l]==-2;)l++;for(;r+h<rowCnt&&n[r+h][t]==-1;)h++;let f=[];f.push(h),f.push(l),i.push(f),t+=l}else t++;i.length>0&&e.push(i)}if(this.debug)for(let r=0;r<n.length;r++){let i=[];for(let t=0;t<n[r].length;t++)i.push(n[r][t]>=0?" "+n[r][t]:n[r][t]);console.log(i.join(","))}return e},"getHtmlStructure"),deleteColAt:m(function(e,n,r){let i=A(e,n,this.mt),t=this.mt,l=t.length,h=[];if(r==!0)for(;i+1<t[e].length&&t[e][i+1]==-2;)i++;for(let f=0;f<l;f++)if(t[f][i]<0){let u=f,s=i;for(;s>=0&&t[u][s]==-2;)s--;for(;u>=0&&t[u][s]==-1;)u--;let o=[];o.push(u),o.push(s>=0?S(u,s,this.mt):s),C(h,o)}else{let u=[];u.push(f),u.push(S(f,i,this.mt)),C(h,u)}return h},"deleteColAt"),deleteRowAt:m(function(e){let n=this.mt,r=n.length,i=[];if(e>=0&&e<n.length)for(let t=0;t<n[e].length;t++)if(n[e][t]<0){let l=e,h=t;for(;h>=0&&n[l][h]==-2;)h--;for(;l>=0&&n[l][h]==-1;)l--;let f=[];f.push(l),f.push(h>=0?S(l,h,this.mt):h),C(i,f)}else{let l=[];l.push(e),l.push(S(e,t,this.mt)),C(i,l)}return i},"deleteRowAt"),insertableCellNextRow:m(function(e,n){let r=A(e,n,this.mt),i=[];return r>=0&&e<this.mt.length-1&&(i=k(e+1,r,this.mt)),i},"insertableCellNextRow"),insertableCell:m(function(e,n){let r=A(e,n,this.mt);return k(e,r,this.mt)},"insertableCell"),beforeCell:m(function(e,n,r){let i=A(e,n,this.mt),t=this.mt,l=[];for(let h=0;h<r;h++){let f=i-1,u=e+h;for(;f>=0&&t[u][f]<0;)f--;let s=[];s.push(u),s.push(f>=0?S(u,f,this.mt):f),l.push(s)}return l},"beforeCell"),absoluteCol:m(function(e,n){return A(e,n,this.mt)},"absoluteCol"),getRowSize:m(function(e){let n=0;return e>=0&&e<this.mt.length&&(n=this.mt[e].length),n},"getRowSize"),hasCell:m(function(e,n){let r=A(e,n,this.mt),i=!1;return e>=0&&e<this.mt.length&&r>=0&&r<this.mt[e].length&&(i=this.mt[e][r]>0),i},"hasCell"),getMatrix:m(function(){return this.mt},"getMatrix"),extendSize:m(function(e,n,r,i){let t=A(e,n,this.mt),l=this.mt,h={},f=0,u=[],s=[],o=1,p=1;for(let g=t+1;g<l[e].length&&l[e][g]==-2;g++)p++;for(let g=e+1;g<l.length&&l[g][t]==-1;g++)o++;if(r>o||i>p){let g={row:e,col:t},a=1,d;if(i>p){for(let c=t+1;c<l[e].length&&l[e][c]!=-1;c++)if(a++,a==i){d={row:e,col:c};break}a!=i&&f==0&&(f=-1)}else d={row:e,col:t+i-1};a=1;let b;if(r>o){for(let c=e+1;c<l.length&&l[c][t]!=-2;c++)if(a++,a==r){b={row:c,col:t};break}a!=r&&f==0&&(f=-2)}else b={row:e+r-1,col:t};let w={row:e+o-1,col:t+p-1};if(b.row+1<l.length){let c=b.row+1;for(let I=b.col;I<=d.col;I++)if((c>w.row||I>w.col)&&l[c][I]==-1){f=-1;break}}let x=d.col+1;for(let c=d.row;c<=b.row;c++)if((c>w.row||x>w.col)&&x<l[c].length&&l[c][x]==-2){f=-2;break}let M={row:b.row,col:d.col};for(let c=g.row;c<=b.row;c++)for(let I=g.col;I<=d.col;I++)if(l[c][I]>0){let R=[];R.push(c),R.push(S(c,I,this.mt)),C(u,R)}}if(r<o||i<p)for(let g=0;g<o;g++){let a=0,d;g<r?(a=p-i,a>0&&(d=k(e+g,t,l))):(a=p,d=k(e+g,t,l)),a>0&&s.push({row:e+g,start:d,howMany:a})}return h.errorCode=f,h.mergeCells=u,h.splitCells=s,h},"extendSize")}}(),window.Table2Matrix=j})();
//# sourceMappingURL=mtable.min.js.map
